       IDENTIFICATION DIVISION. 
       PROGRAM-ID. TRADER-REPORT.
       AUTHOR. HEX (62160246)
       ENVIRONMENT DIVISION. 
       INPUT-OUTPUT SECTION.
       FILE-CONTROL. 
           SELECT TRADER-DATA-FILE ASSIGN TO "trader6.dat"
              ORGANIZATION IS LINE SEQUENTIAL.
       DATA DIVISION.
       FILE SECTION. 
       FD  TRADER-DATA-FILE.
       01  TRADER-RECORD.
           88 END-OF-TRADER-FILE VALUE HIGH-VALUES 
           .
       05  PROVINCE-ID PIC 9(2).
           05 TRADER-ID PIC 9(4).
           05 TRADER-PROFIT  PIC 9(6).
       WORKING-STORAGE SECTION.
       
      *    FORMAT US DOLLAR
       01  US-FORMAT-DETAIL PIC $B(5)$$$,$$$,$$9.
           

       01  PROVINCE-INDEX PIC 9(2).
       01  HEADER-REPORT PIC X(54) VALUE 
       "PROVINCE    P INCOME       MEMBER        MEMBER INCOME".
       
       01  PROVINCE-TABLE.
           05 PROVINCE-TOTAL OCCURS 77 TIMES.
              10 PROVINCE-PROFIT-TOTAL   PIC 9(9).
              10 PROVINCE-BEST-TRADER    PIC 9(4).
              10 PROVINCE-BEST-TRADER-PROFIT PIC 9(6) VALUE ZEROES.
       PROCEDURE DIVISION.
       MAIN.

      *    READ FILE.
           OPEN INPUT TRADER-DATA-FILE
           READ TRADER-DATA-FILE 
           AT END 
              SET END-OF-TRADER-FILE TO TRUE
           END-READ



      *    LOOP TRADER DATA ( COMPUTED "P INCOME" ).    
           PERFORM UNTIL END-OF-TRADER-FILE 
              
              ADD TRADER-PROFIT TO PROVINCE-PROFIT-TOTAL(PROVINCE-ID)
              
              IF PROVINCE-BEST-TRADER-PROFIT(PROVINCE-ID) 
              LESS THAN TRADER-PROFIT THEN
                 MOVE TRADER-PROFIT TO 
                    PROVINCE-BEST-TRADER-PROFIT(PROVINCE-ID)
                 MOVE TRADER-ID TO 
                    PROVINCE-BEST-TRADER(PROVINCE-ID) 
              END-IF 
             
             
      *       THIS LIKE A READ NEXT LINE IN JAVA ...
              READ TRADER-DATA-FILE
              AT END
                 SET END-OF-TRADER-FILE TO TRUE
              END-READ 
           END-PERFORM
           
      *    DISPLAY RESULT
           DISPLAY HEADER-REPORT
           PERFORM VARYING PROVINCE-INDEX FROM 1 BY 1
           UNTIL PROVINCE-INDEX GREATER THAN 77
              DISPLAY "    " PROVINCE-INDEX WITH NO ADVANCING
              MOVE PROVINCE-PROFIT-TOTAL(PROVINCE-INDEX) 
              TO US-FORMAT-DETAIL
              DISPLAY US-FORMAT-DETAIL WITH NO ADVANCING 
              DISPLAY "     " PROVINCE-BEST-TRADER(PROVINCE-INDEX)
                 WITH NO ADVANCING 
              MOVE PROVINCE-BEST-TRADER-PROFIT(PROVINCE-INDEX)  
              TO US-FORMAT-DETAIL
              DISPLAY US-FORMAT-DETAIL
           END-PERFORM 
           .